import { auth } from './services/firebase';
import React, { useState, useMemo, useEffect } from 'react';
import { 
  HashRouter, 
  Routes, 
  Route, 
  Link, 
  useLocation, 
  useNavigate, 
  Navigate 
} from 'react-router-dom';
import { 
  Crown, Lock, LayoutGrid, Settings, ChevronLeft, Search,
  Loader2, RefreshCw, Zap, BrainCircuit, CheckCircle2,
  LogOut, UserCircle, Target, Activity, AlertCircle, Goal, AlertTriangle,
  Share2, TrendingUp, Globe, Trophy
} from 'lucide-react';
import { 
  signInWithEmailAndPassword, 
  createUserWithEmailAndPassword, 
  onAuthStateChanged, 
  signOut,
  User as FirebaseUser 
} from "firebase/auth";

import { FootballMatch, Confidence, Language, BetType, TeamStats } from './types';
import { MatchCard } from './components/MatchCard';
import { VipSafeCard } from './components/VipSafeCard';
import { ConfidenceIndicator } from './components/ConfidenceIndicator';
import { generatePredictionsAndAnalysis, AnalysisResult } from './services/geminiService';
import { fetchMatchesByDate, fetchStandings } from './services/footballApiService';

const ADMIN_CODE = "20202020";
const PAYMENT_LINK = "https://bsbxsvng.mychariow.shop/prd_g3zdgh/checkout";

const VALID_CODES_ARRAY = [
  "BETIQ-5", "BETIQ-24", "BETIQ-55", "BETIQ-98", "BETIQ-153", "BETIQ-220", "BETIQ-299", "BETIQ-390", "BETIQ-493", "BETIQ-608", "BETIQ-735", "BETIQ-874", "BETIQ-1025", "BETIQ-1188", "BETIQ-1363", "BETIQ-1550", "BETIQ-1749", "BETIQ-1960", "BETIQ-2183", "BETIQ-2418", "BETIQ-2665", "BETIQ-2924", "BETIQ-3195", "BETIQ-3478", "BETIQ-3773", "BETIQ-4080", "BETIQ-4399", "BETIQ-4730", "BETIQ-5073", "BETIQ-5428", "BETIQ-5795", "BETIQ-6174", "BETIQ-6565", "BETIQ-6968", "BETIQ-7383", "BETIQ-7810", "BETIQ-8249", "BETIQ-8700", "BETIQ-9163", "BETIQ-9638", "BETIQ-10125", "BETIQ-10624", "BETIQ-11135", "BETIQ-11658", "BETIQ-12193", "BETIQ-12740", "BETIQ-13299", "BETIQ-13870", "BETIQ-14453", "BETIQ-15048", "BETIQ-15655", "BETIQ-16274", "BETIQ-16905", "BETIQ-17548", "BETIQ-18203", "BETIQ-18870", "BETIQ-19549", "BETIQ-20240", "BETIQ-20943", "BETIQ-21658", "BETIQ-22385", "BETIQ-23124", "BETIQ-23875", "BETIQ-24638", "BETIQ-25413", "BETIQ-26200", "BETIQ-26999", "BETIQ-27810", "BETIQ-28633", "BETIQ-29468", "BETIQ-30315", "BETIQ-31174", "BETIQ-32045", "BETIQ-32928", "BETIQ-33823", "BETIQ-34730", "BETIQ-35649", "BETIQ-36580", "BETIQ-37523", "BETIQ-38478", "BETIQ-39445", "BETIQ-40424", "BETIQ-41415", "BETIQ-42418", "BETIQ-43433", "BETIQ-44460", "BETIQ-45499", "BETIQ-46550", "BETIQ-47613", "BETIQ-48688", "BETIQ-49775", "BETIQ-50874", "BETIQ-51985", "BETIQ-53108", "BETIQ-54243", "BETIQ-55390", "BETIQ-56549", "BETIQ-57720", "BETIQ-58903", "BETIQ-60098", "BETIQ-61305", "BETIQ-62524", "BETIQ-63755", "BETIQ-64998", "BETIQ-66253", "BETIQ-67520", "BETIQ-68799", "BETIQ-70090", "BETIQ-71393", "BETIQ-72708", "BETIQ-74035", "BETIQ-75374", "BETIQ-76725", "BETIQ-78088", "BETIQ-79463", "BETIQ-80850", "BETIQ-82249", "BETIQ-83660", "BETIQ-85083", "BETIQ-86518", "BETIQ-87965", "BETIQ-89424", "BETIQ-90895", "BETIQ-92378", "BETIQ-93873", "BETIQ-95380", "BETIQ-96899", "BETIQ-98430", "BETIQ-99973", "BETIQ-101528", "BETIQ-103095", "BETIQ-104674", "BETIQ-106265", "BETIQ-107868", "BETIQ-109483", "BETIQ-111110", "BETIQ-112749", "BETIQ-114400", "BETIQ-116063", "BETIQ-117738", "BETIQ-119425", "BETIQ-121124", "BETIQ-122835", "BETIQ-124558", "BETIQ-126293", "BETIQ-128040", "BETIQ-129799", "BETIQ-131570", "BETIQ-133353", "BETIQ-135148", "BETIQ-136955", "BETIQ-138774", "BETIQ-140605", "BETIQ-142448", "BETIQ-144303", "BETIQ-146170", "BETIQ-148049", "BETIQ-149940", "BETIQ-151843", "BETIQ-153758", "BETIQ-155685", "BETIQ-157624", "BETIQ-159575", "BETIQ-161538", "BETIQ-163513", "BETIQ-165500", "BETIQ-167499", "BETIQ-169510", "BETIQ-171533", "BETIQ-173568", "BETIQ-175615", "BETIQ-177674", "BETIQ-179745", "BETIQ-181828", "BETIQ-183923", "BETIQ-186030", "BETIQ-188149", "BETIQ-190280", "BETIQ-192423", "BETIQ-194578", "BETIQ-196745", "BETIQ-198924", "BETIQ-201115", "BETIQ-203318", "BETIQ-205533", "BETIQ-207760", "BETIQ-209999", "BETIQ-212250", "BETIQ-214513", "BETIQ-216788", "BETIQ-219075", "BETIQ-221374", "BETIQ-223685", "BETIQ-226008", "BETIQ-228343", "BETIQ-230690", "BETIQ-233049", "BETIQ-235420", "BETIQ-237803", "BETIQ-240198", "BETIQ-242605", "BETIQ-245024", "BETIQ-247455", "BETIQ-249898", "BETIQ-252353", "BETIQ-254820", "BETIQ-257299", "BETIQ-259790", "BETIQ-262293", "BETIQ-264808", "BETIQ-267335", "BETIQ-269874", "BETIQ-272425", "BETIQ-274988", "BETIQ-277563", "BETIQ-280150", "BETIQ-282749", "BETIQ-285360", "BETIQ-287983", "BETIQ-290618", "BETIQ-293265", "BETIQ-295924", "BETIQ-298595", "BETIQ-301278", "BETIQ-303973", "BETIQ-306680", "BETIQ-309399", "BETIQ-312130", "BETIQ-314873", "BETIQ-317628", "BETIQ-320395", "BETIQ-323174", "BETIQ-325965", "BETIQ-328768", "BETIQ-331583", "BETIQ-334410", "BETIQ-337249", "BETIQ-340100", "BETIQ-342963", "BETIQ-345838", "BETIQ-348725", "BETIQ-351624", "BETIQ-354535", "BETIQ-357458", "BETIQ-360393", "BETIQ-363340", "BETIQ-366299", "BETIQ-369270", "BETIQ-372253", "BETIQ-375248", "BETIQ-378255", "BETIQ-381274", "BETIQ-384305", "BETIQ-387348", "BETIQ-390403", "BETIQ-393470", "BETIQ-396549", "BETIQ-399640", "BETIQ-402743", "BETIQ-405858", "BETIQ-408985", "BETIQ-412124", "BETIQ-415275", "BETIQ-418438", "BETIQ-421613", "BETIQ-424800", "BETIQ-427999", "BETIQ-431210", "BETIQ-434433", "BETIQ-437668", "BETIQ-440915", "BETIQ-444174", "BETIQ-447445", "BETIQ-450728", "BETIQ-454023", "BETIQ-457330", "BETIQ-460649", "BETIQ-463980", "BETIQ-467323", "BETIQ-470678", "BETIQ-474045", "BETIQ-477424", "BETIQ-480815", "BETIQ-484218", "BETIQ-487633", "BETIQ-491060", "BETIQ-494499", "BETIQ-497950", "BETIQ-501413", "BETIQ-504888", "BETIQ-508375", "BETIQ-511874", "BETIQ-515385", "BETIQ-518908", "BETIQ-522443", "BETIQ-525990", "BETIQ-529549", "BETIQ-533120", "BETIQ-536703", "BETIQ-540298", "BETIQ-543905", "BETIQ-547524", "BETIQ-551155", "BETIQ-554798", "BETIQ-558453", "BETIQ-562120", "BETIQ-565799", "BETIQ-569490", "BETIQ-573193", "BETIQ-576908", "BETIQ-580635", "BETIQ-584374", "BETIQ-588125", "BETIQ-591888", "BETIQ-595663", "BETIQ-599450", "BETIQ-603249", "BETIQ-607060", "BETIQ-610883", "BETIQ-614718", "BETIQ-618565", "BETIQ-622424", "BETIQ-626295", "BETIQ-630178", "BETIQ-634073", "BETIQ-637980", "BETIQ-641899", "BETIQ-645830", "BETIQ-649773", "BETIQ-653728", "BETIQ-657695", "BETIQ-661674", "BETIQ-665665", "BETIQ-669668", "BETIQ-673683", "BETIQ-677710", "BETIQ-681749", "BETIQ-685800", "BETIQ-689863", "BETIQ-693938", "BETIQ-698025", "BETIQ-702124", "BETIQ-706235", "BETIQ-710358", "BETIQ-714493", "BETIQ-718640", "BETIQ-722799", "BETIQ-726970", "BETIQ-731153", "BETIQ-735348", "BETIQ-739555", "BETIQ-743774", "BETIQ-748005", "BETIQ-752248", "BETIQ-756503", "BETIQ-760770", "BETIQ-765049", "BETIQ-769340", "BETIQ-773643", "BETIQ-777958", "BETIQ-782285", "BETIQ-786624", "BETIQ-790975", "BETIQ-795338", "BETIQ-799713", "BETIQ-804100", "BETIQ-808499", "BETIQ-812910", "BETIQ-817333", "BETIQ-821768", "BETIQ-826215", "BETIQ-830674", "BETIQ-835145", "BETIQ-839628", "BETIQ-844123", "BETIQ-848630", "BETIQ-853149", "BETIQ-857680", "BETIQ-862223", "BETIQ-866778", "BETIQ-871345", "BETIQ-875924", "BETIQ-880515", "BETIQ-885118", "BETIQ-889733", "BETIQ-894360", "BETIQ-898999", "BETIQ-903650", "BETIQ-908313", "BETIQ-912988", "BETIQ-917675", "BETIQ-922374", "BETIQ-927085", "BETIQ-931808", "BETIQ-936543", "BETIQ-941290", "BETIQ-946049", "BETIQ-950820", "BETIQ-955603", "BETIQ-960398", "BETIQ-965205", "BETIQ-970024", "BETIQ-974855", "BETIQ-979698", "BETIQ-984553", "BETIQ-989420", "BETIQ-994299", "BETIQ-999190", "BETIQ-1004093", "BETIQ-1009008", "BETIQ-1013935", "BETIQ-1018874", "BETIQ-1023825", "BETIQ-1028788", "BETIQ-1033763", "BETIQ-1038750", "BETIQ-1043749", "BETIQ-1048760", "BETIQ-1053783", "BETIQ-1058818", "BETIQ-1063865", "BETIQ-1068924", "BETIQ-1073995", "BETIQ-10791025", "BETIQ-1084173", "BETIQ-1089280", "BETIQ-1094399", "BETIQ-1099530", "BETIQ-1104673", "BETIQ-1109828", "BETIQ-1114995", "BETIQ-1120174", "BETIQ-1125365", "BETIQ-1130568", "BETIQ-1135783", "BETIQ-1141010", "BETIQ-1146249", "BETIQ-1151500", "BETIQ-1156763", "BETIQ-1162038", "BETIQ-1167325", "BETIQ-1172624", "BETIQ-1177935", "BETIQ-1183258", "BETIQ-1188593", "BETIQ-1193940", "BETIQ-1199299", "BETIQ-1204670", "BETIQ-1210053", "BETIQ-1215448", "BETIQ-1220855", "BETIQ-1226274", "BETIQ-1231705", "BETIQ-1237148", "BETIQ-1242603", "BETIQ-1248070", "BETIQ-1253549", "BETIQ-1259040", "BETIQ-1264543", "BETIQ-1270058", "BETIQ-1275585", "BETIQ-1281124", "BETIQ-1286675", "BETIQ-1292238", "BETIQ-1297813", "BETIQ-1303400", "BETIQ-1308999", "BETIQ-1314610", "BETIQ-1320233", "BETIQ-1325868", "BETIQ-1331515", "BETIQ-1337174", "BETIQ-1342845", "BETIQ-1348528", "BETIQ-1354223", "BETIQ-1359930", "BETIQ-1365649", "BETIQ-1371380", "BETIQ-1377123", "BETIQ-1382878", "BETIQ-1388645", "BETIQ-1394424", "BETIQ-1400215", "BETIQ-1406018", "BETIQ-1411833", "BETIQ-1417660", "BETIQ-1423499", "BETIQ-1429350", "BETIQ-1435213", "BETIQ-1441088", "BETIQ-1446975", "BETIQ-1452874", "BETIQ-1458785", "BETIQ-1464708", "BETIQ-1470643", "BETIQ-1476590", "BETIQ-1482549", "BETIQ-1488520", "BETIQ-1494503", "BETIQ-1500498", "BETIQ-1506505", "BETIQ-1512524", "BETIQ-1518555", "BETIQ-1524598", "BETIQ-1530653", "BETIQ-1536720", "BETIQ-1542799", "BETIQ-1548890", "BETIQ-1554993", "BETIQ-1561108", "BETIQ-1567235", "BETIQ-1573374", "BETIQ-1579525", "BETIQ-1585688", "BETIQ-1591863", "BETIQ-1598050", "BETIQ-1604249", "BETIQ-1610460", "BETIQ-1616683", "BETIQ-1622918", "BETIQ-1629165", "BETIQ-1635424", "BETIQ-1641695", "BETIQ-1647978", "BETIQ-1654273", "BETIQ-1660580", "BETIQ-1666899", "BETIQ-1673230", "BETIQ-1679573", "BETIQ-1685928", "BETIQ-1692295", "BETIQ-1698674", "BETIQ-1705065", "BETIQ-1711468", "BETIQ-1717883", "BETIQ-1724310", "BETIQ-1730749", "BETIQ-1737200", "BETIQ-1743663", "BETIQ-1750138", "BETIQ-1756625", "BETIQ-1763124", "BETIQ-1769635", "BETIQ-1776158", "BETIQ-1782693", "BETIQ-1789240", "BETIQ-1795799", "BETIQ-1802370", "BETIQ-1808953", "BETIQ-1815548", "BETIQ-1822155", "BETIQ-1828774", "BETIQ-1835405", "BETIQ-1842048", "BETIQ-1848703", "BETIQ-1855370", "BETIQ-1862049", "BETIQ-1868740", "BETIQ-1875443", "BETIQ-1882158", "BETIQ-1888885", "BETIQ-1895624", "BETIQ-1902375", "BETIQ-1909138", "BETIQ-1915913", "BETIQ-1922700", "BETIQ-1929499", "BETIQ-1936310", "BETIQ-1943133", "BETIQ-1949968", "BETIQ-1956815", "BETIQ-1963674", "BETIQ-1970545", "BETIQ-1977428", "BETIQ-1984323", "BETIQ-1991230", "BETIQ-1998149", "BETIQ-2005080", "BETIQ-2012023", "BETIQ-2018978", "BETIQ-2025945", "BETIQ-2032924", "BETIQ-2039915", "BETIQ-2046918", "BETIQ-2053933", "BETIQ-2060960", "BETIQ-2067999", "BETIQ-2075050", "BETIQ-2082113", "BETIQ-2089188", "BETIQ-2096275", "BETIQ-2103374", "BETIQ-2110485", "BETIQ-2117608", "BETIQ-2124743", "BETIQ-2131890", "BETIQ-2139049", "BETIQ-2146220", "BETIQ-2153403", "BETIQ-2160598", "BETIQ-2167805", "BETIQ-2175024", "BETIQ-2182255", "BETIQ-2189498", "BETIQ-2196753", "BETIQ-2204020", "BETIQ-2211299", "BETIQ-2218590", "BETIQ-2225893", "BETIQ-2233208", "BETIQ-2240535", "BETIQ-2247874", "BETIQ-2255225", "BETIQ-2262588", "BETIQ-2269963", "BETIQ-2277350", "BETIQ-2284749", "BETIQ-2292160", "BETIQ-2299583", "BETIQ-2307018", "BETIQ-2314465", "BETIQ-2321924", "BETIQ-2329395", "BETIQ-2336878", "BETIQ-2344373", "BETIQ-2351880", "BETIQ-2359399", "BETIQ-2366930", "BETIQ-2374473", "BETIQ-2382028", "BETIQ-2389595", "BETIQ-2397174", "BETIQ-2404765", "BETIQ-2412368", "BETIQ-2419983", "BETIQ-2427610", "BETIQ-2435249", "BETIQ-2442900", "BETIQ-2450563", "BETIQ-2458238", "BETIQ-2465925", "BETIQ-2473624", "BETIQ-2481335", "BETIQ-2489058", "BETIQ-2496793", "BETIQ-2504540", "BETIQ-2512299", "BETIQ-2520070", "BETIQ-2527853", "BETIQ-2535648", "BETIQ-2543455", "BETIQ-2551274", "BETIQ-2559105", "BETIQ-2566948", "BETIQ-2574803", "BETIQ-2582670", "BETIQ-2590549", "BETIQ-2598440", "BETIQ-2606343", "BETIQ-2614258", "BETIQ-2622185", "BETIQ-2630124", "BETIQ-2638075", "BETIQ-2646038", "BETIQ-2654013", "BETIQ-2662000", "BETIQ-2669999", "BETIQ-2678010", "BETIQ-2686033", "BETIQ-2694068", "BETIQ-2702115", "BETIQ-2710174", "BETIQ-2718245", "BETIQ-2726328", "BETIQ-2734423", "BETIQ-2742530", "BETIQ-2750649", "BETIQ-2758780", "BETIQ-2766923", "BETIQ-2775078", "BETIQ-2783245", "BETIQ-2791424", "BETIQ-2799615", "BETIQ-2807818", "BETIQ-2816033", "BETIQ-2824260", "BETIQ-2832499", "BETIQ-2840750", "BETIQ-2849013", "BETIQ-2857288", "BETIQ-2865575", "BETIQ-2873874", "BETIQ-2882185", "BETIQ-2890508", "BETIQ-2898843", "BETIQ-2907190", "BETIQ-2915549", "BETIQ-2923920", "BETIQ-2932303", "BETIQ-2940698", "BETIQ-2949105", "BETIQ-2957524", "BETIQ-2965955", "BETIQ-2974398", "BETIQ-2982853", "BETIQ-2991320", "BETIQ-2999799", "BETIQ-3008290", "BETIQ-3016793", "BETIQ-3025308", "BETIQ-3033835", "BETIQ-3042374", "BETIQ-3050925", "BETIQ-3059488", "BETIQ-3068063", "BETIQ-3076650", "BETIQ-3085249", "BETIQ-3093860", "BETIQ-3102483", "BETIQ-3111118", "BETIQ-3119765", "BETIQ-3128424", "BETIQ-3137095", "BETIQ-3145778", "BETIQ-3154473", "BETIQ-3163180", "BETIQ-3171899", "BETIQ-3180630", "BETIQ-3189373", "BETIQ-3198128", "BETIQ-3206895", "BETIQ-3215674", "BETIQ-3224465", "BETIQ-3233268", "BETIQ-3242083", "BETIQ-3250910", "BETIQ-3259749", "BETIQ-3268600", "BETIQ-3277463", "BETIQ-3286338", "BETIQ-3295225", "BETIQ-3304124", "BETIQ-3313035", "BETIQ-3321958", "BETIQ-3330893", "BETIQ-3339840", "BETIQ-3348799", "BETIQ-3357770", "BETIQ-3366753", "BETIQ-3375748", "BETIQ-3384755", "BETIQ-3393774", "BETIQ-3402805", "BETIQ-3411848", "BETIQ-3420903", "BETIQ-3429970", "BETIQ-3439049", "BETIQ-3448140", "BETIQ-3457243", "BETIQ-3466358", "BETIQ-3475485", "BETIQ-3484624", "BETIQ-3493775", "BETIQ-3502938", "BETIQ-3512113", "BETIQ-3521300", "BETIQ-3530499", "BETIQ-3539710", "BETIQ-3548933", "BETIQ-3558168", "BETIQ-3567415", "BETIQ-3576674", "BETIQ-3585945", "BETIQ-3595228", "BETIQ-3604523", "BETIQ-3613830", "BETIQ-3623149", "BETIQ-3632480", "BETIQ-3641823", "BETIQ-3651178", "BETIQ-3660545", "BETIQ-3669924", "BETIQ-3679315", "BETIQ-3688718", "BETIQ-3698133", "BETIQ-3707560", "BETIQ-3716999", "BETIQ-3726450", "BETIQ-3735913", "BETIQ-3745388", "BETIQ-3754875", "BETIQ-3764374", "BETIQ-3773885", "BETIQ-3783408", "BETIQ-3792943", "BETIQ-3802490", "BETIQ-3812049", "BETIQ-3821620", "BETIQ-3831203", "BETIQ-3840798", "BETIQ-3850405", "BETIQ-3860024", "BETIQ-3869655", "BETIQ-3879298", "BETIQ-3888953", "BETIQ-3898620", "BETIQ-3908299", "BETIQ-3917990", "BETIQ-3927693", "BETIQ-3937408", "BETIQ-3947135", "BETIQ-3956874", "BETIQ-3966625", "BETIQ-3976388", "BETIQ-3986163", "BETIQ-3995950", "BETIQ-4005749", "BETIQ-4015560", "BETIQ-4025383", "BETIQ-4035218", "BETIQ-4045065", "BETIQ-4054924", "BETIQ-4064795", "BETIQ-4074678", "BETIQ-4084573", "BETIQ-4094480", "BETIQ-4104399", "BETIQ-4114330", "BETIQ-4124273", "BETIQ-4134228", "BETIQ-4144195", "BETIQ-4154174", "BETIQ-4164165", "BETIQ-4174168", "BETIQ-4184183", "BETIQ-4194210", "BETIQ-4204249", "BETIQ-4214300", "BETIQ-4224363", "BETIQ-4234438", "BETIQ-4244525", "BETIQ-4254624", "BETIQ-4264735", "BETIQ-4274858", "BETIQ-4284993", "BETIQ-4295140", "BETIQ-4305299", "BETIQ-4315470", "BETIQ-4325653", "BETIQ-4335848", "BETIQ-4346055", "BETIQ-4356274", "BETIQ-4366505", "BETIQ-4376748", "BETIQ-4387003", "BETIQ-4397270", "BETIQ-4407549", "BETIQ-4417840", "BETIQ-4428143", "BETIQ-4438458", "BETIQ-4448785", "BETIQ-4459124", "BETIQ-4469475", "BETIQ-4479838", "BETIQ-4490213", "BETIQ-4500600", "BETIQ-4510999", "BETIQ-4521410", "BETIQ-4531833", "BETIQ-4542268", "BETIQ-4552715", "BETIQ-4563174", "BETIQ-4573645", "BETIQ-4584128", "BETIQ-4594623", "BETIQ-4605130", "BETIQ-4615649", "BETIQ-4626180", "BETIQ-4636723", "BETIQ-4647278", "BETIQ-4657845", "BETIQ-4668424", "BETIQ-4679015", "BETIQ-4689618", "BETIQ-4700233", "BETIQ-4710860", "BETIQ-4721499", "BETIQ-4732150", "BETIQ-4742813", "BETIQ-4753488", "BETIQ-4764175", "BETIQ-4774874", "BETIQ-4785585", "BETIQ-4796308", "BETIQ-4807043", "BETIQ-4817790", "BETIQ-4828549", "BETIQ-4839320", "BETIQ-4850103", "BETIQ-4860898", "BETIQ-4871705", "BETIQ-4882524", "BETIQ-4893355", "BETIQ-4904198", "BETIQ-4915053", "BETIQ-4925920", "BETIQ-4936799", "BETIQ-4947690", "BETIQ-4958593", "BETIQ-4969508", "BETIQ-4980435", "BETIQ-4991374", "BETIQ-5002325", "BETIQ-5013288", "BETIQ-5024263", "BETIQ-5035250", "BETIQ-5046249", "BETIQ-5057260", "BETIQ-5068283", "BETIQ-5079318", "BETIQ-5090365", "BETIQ-5101424", "BETIQ-5112495", "BETIQ-5123578", "BETIQ-5134673", "BETIQ-5145780", "BETIQ-5156899", "BETIQ-5168030", "BETIQ-5179173", "BETIQ-5190328", "BETIQ-5201495", "BETIQ-5212674", "BETIQ-5223865", "BETIQ-5235068", "BETIQ-5246283", "BETIQ-5257510", "BETIQ-5268749", "BETIQ-5280000", "BETIQ-5291263", "BETIQ-5302538", "BETIQ-5313825", "BETIQ-5325124", "BETIQ-5336435", "BETIQ-5347758", "BETIQ-5359093", "BETIQ-5370440", "BETIQ-5381799", "BETIQ-5393170", "BETIQ-5404553", "BETIQ-5415948", "BETIQ-5427355", "BETIQ-5438774", "BETIQ-5450205", "BETIQ-5461648", "BETIQ-5473103", "BETIQ-5484570", "BETIQ-5496049", "BETIQ-5507540", "BETIQ-5519043", "BETIQ-5530558", "BETIQ-5542085", "BETIQ-5553624", "BETIQ-5565175", "BETIQ-5576738", "BETIQ-5588313", "BETIQ-5599900", "BETIQ-5611499", "BETIQ-5623110", "BETIQ-5634733", "BETIQ-5646368", "BETIQ-5658015", "BETIQ-5669674", "BETIQ-5681345", "BETIQ-5693028", "BETIQ-5704723", "BETIQ-5716430", "BETIQ-5728149", "BETIQ-5739880", "BETIQ-5751623", "BETIQ-5763378", "BETIQ-5775145", "BETIQ-5786924", "BETIQ-5798715", "BETIQ-5810518", "BETIQ-5822333", "BETIQ-5834160", "BETIQ-5845999", "BETIQ-5857850", "BETIQ-5869713", "BETIQ-5881588", "BETIQ-5893475", "BETIQ-5905374", "BETIQ-5917285", "BETIQ-5929208", "BETIQ-5941143", "BETIQ-5953090", "BETIQ-5965049", "BETIQ-5977020", "BETIQ-5989003", "BETIQ-6000998", "BETIQ-6013005", "BETIQ-6025024", "BETIQ-6037055", "BETIQ-6049098", "BETIQ-6061153", "BETIQ-6073220", "BETIQ-6085299", "BETIQ-6097390", "BETIQ-6109493", "BETIQ-6121608", "BETIQ-6133735", "BETIQ-6145874", "BETIQ-6158025", "BETIQ-6170188", "BETIQ-6182363", "BETIQ-6194550", "BETIQ-6206749", "BETIQ-6218960", "BETIQ-6231183", "BETIQ-6243418", "BETIQ-6255665", "BETIQ-6267924", "BETIQ-6280195", "BETIQ-6292478", "BETIQ-6304773", "BETIQ-6317080", "BETIQ-6329399", "BETIQ-6341730", "BETIQ-6354073", "BETIQ-6366428", "BETIQ-6378795", "BETIQ-6391174", "BETIQ-6403565", "BETIQ-6415968", "BETIQ-6428383", "BETIQ-6440810", "BETIQ-6453249", "BETIQ-6465700", "BETIQ-6478163", "BETIQ-6490638", "BETIQ-6503125", "BETIQ-6515624", "BETIQ-6528135", "BETIQ-6540658", "BETIQ-6553193", "BETIQ-6565740", "BETIQ-6578299", "BETIQ-6590870", "BETIQ-6603453", "BETIQ-6616048", "BETIQ-6628655", "BETIQ-6641274", "BETIQ-6653905", "BETIQ-6666548", "BETIQ-6679203", "BETIQ-6691870", "BETIQ-6704549", "BETIQ-6717240", "BETIQ-6729943", "BETIQ-6742658", "BETIQ-6755385", "BETIQ-6768124", "BETIQ-6780875", "BETIQ-6793638", "BETIQ-6806413", "BETIQ-6819200", "BETIQ-6831999", "BETIQ-6844810", "BETIQ-6857633", "BETIQ-6870468", "BETIQ-6883315", "BETIQ-6896174", "BETIQ-6909045", "BETIQ-6921928", "BETIQ-6934823", "BETIQ-6947730", "BETIQ-6960649", "BETIQ-6973580", "BETIQ-6986523", "BETIQ-6999478", "BETIQ-7012445", "BETIQ-7025424", "BETIQ-7038415", "BETIQ-7051418", "BETIQ-7064433", "BETIQ-7077460", "BETIQ-7090499", "BETIQ-7103550", "BETIQ-7116613", "BETIQ-7129688", "BETIQ-7142775", "BETIQ-7155874", "BETIQ-7168985", "BETIQ-7182108", "BETIQ-7195243", "BETIQ-7208390", "BETIQ-7221549", "BETIQ-7234720", "BETIQ-7247903", "BETIQ-7261098", "BETIQ-7274305", "BETIQ-7287524", "BETIQ-7300755", "BETIQ-7313998", "BETIQ-7327253", "BETIQ-7340520", "BETIQ-7353799", "BETIQ-7367090", "BETIQ-7380393", "BETIQ-7393708", "BETIQ-7407035", "BETIQ-7420374", "BETIQ-7433725", "BETIQ-7447088", "BETIQ-7460463", "BETIQ-7473850", "BETIQ-7487249", "BETIQ-7500660", "BETIQ-7514083", "BETIQ-7527518", "BETIQ-7540965", "BETIQ-7554424", "BETIQ-7567895", "BETIQ-7581378", "BETIQ-7594873", "BETIQ-7608380", "BETIQ-7621899", "BETIQ-7635430", "BETIQ-7648973", "BETIQ-7662528", "BETIQ-7676095", "BETIQ-7689674", "BETIQ-7703265", "BETIQ-7716868", "BETIQ-7730483", "BETIQ-7744110", "BETIQ-7757749", "BETIQ-7771400", "BETIQ-7785063", "BETIQ-7798738", "BETIQ-7812425", "BETIQ-7826124", "BETIQ-7839835", "BETIQ-7853558", "BETIQ-7867293", "BETIQ-7881040", "BETIQ-7894799", "BETIQ-7908570", "BETIQ-7922353", "BETIQ-7936148", "BETIQ-7949955", "BETIQ-7963774", "BETIQ-7977605", "BETIQ-7991448", "BETIQ-8005303", "BETIQ-8019170", "BETIQ-8033049", "BETIQ-8046940", "BETIQ-8060843", "BETIQ-8074758", "BETIQ-8088685", "BETIQ-8102624", "BETIQ-8116575", "BETIQ-8130538", "BETIQ-8144513", "BETIQ-8158500", "BETIQ-8172499", "BETIQ-8186510", "BETIQ-8200533", "BETIQ-8214568", "BETIQ-8228615", "BETIQ-8242674", "BETIQ-8256745", "BETIQ-8270828", "BETIQ-8284923", "BETIQ-8299030", "BETIQ-8313149", "BETIQ-8327280", "BETIQ-8341423", "BETIQ-8355578", "BETIQ-8369745", "BETIQ-8383924", "BETIQ-8398115", "BETIQ-8412318", "BETIQ-8426533", "BETIQ-8440760", "BETIQ-8454999", "BETIQ-8469250", "BETIQ-8483513", "BETIQ-8497788", "BETIQ-8512075", "BETIQ-8526374", "BETIQ-8540685", "BETIQ-8555008", "BETIQ-8569343", "BETIQ-8583690", "BETIQ-8598049", "BETIQ-8612420", "BETIQ-8626803", "BETIQ-8641198", "BETIQ-8655605", "BETIQ-8670024", "BETIQ-8684455", "BETIQ-8698898", "BETIQ-8713353", "BETIQ-8727820", "BETIQ-8742299", "BETIQ-8756790", "BETIQ-8771293", "BETIQ-8785808", "BETIQ-8800335", "BETIQ-8814874", "BETIQ-8829425", "BETIQ-8843988", "BETIQ-8858563", "BETIQ-8873150", "BETIQ-8887749", "BETIQ-8902360", "BETIQ-8916983", "BETIQ-8931618", "BETIQ-8946265", "BETIQ-8960924", "BETIQ-8975595", "BETIQ-8990278", "BETIQ-9004973", "BETIQ-9019680", "BETIQ-9034399", "BETIQ-9049130", "BETIQ-9063873", "BETIQ-9078628", "BETIQ-9093395", "BETIQ-9108174", "BETIQ-9122965", "BETIQ-9137768", "BETIQ-9152583", "BETIQ-9167410", "BETIQ-9182249", "BETIQ-9197100", "BETIQ-9211963", "BETIQ-9226838", "BETIQ-9241725", "BETIQ-9256624", "BETIQ-9271535", "BETIQ-9286458", "BETIQ-9301393", "BETIQ-9316340", "BETIQ-9331299", "BETIQ-9346270", "BETIQ-9361253", "BETIQ-9376248", "BETIQ-9391255", "BETIQ-9406274", "BETIQ-9421305", "BETIQ-9436348", "BETIQ-9451403", "BETIQ-9466470", "BETIQ-9481549", "BETIQ-9496640", "BETIQ-9511743", "BETIQ-9526858", "BETIQ-9541985", "BETIQ-9557124", "BETIQ-9572275", "BETIQ-9587438", "BETIQ-9602613", "BETIQ-9617800", "BETIQ-9632999", "BETIQ-9648210", "BETIQ-9663433", "BETIQ-9678668", "BETIQ-9693915", "BETIQ-9709174", "BETIQ-9724445", "BETIQ-9739728", "BETIQ-9755023", "BETIQ-9770330", "BETIQ-9785649", "BETIQ-9800980", "BETIQ-9816323", "BETIQ-9831678", "BETIQ-9847045", "BETIQ-9862424", "BETIQ-9877815", "BETIQ-9893218", "BETIQ-9908633", "BETIQ-9924060", "BETIQ-9939499", "BETIQ-9954950", "BETIQ-9970413", "BETIQ-9985888", "BETIQ-10001375", "BETIQ-10016874", "BETIQ-10032385", "BETIQ-10047908", "BETIQ-10063443", "BETIQ-10078990", "BETIQ-10094549", "BETIQ-10110120", "BETIQ-10125703", "BETIQ-10141298", "BETIQ-10156905", "BETIQ-10172524", "BETIQ-10188155", "BETIQ-10203798", "BETIQ-10219453", "BETIQ-10235120", "BETIQ-10250799", "BETIQ-10266490", "BETIQ-10282193", "BETIQ-10297908", "BETIQ-10313635", "BETIQ-10329374", "BETIQ-10345125", "BETIQ-10360888", "BETIQ-10376663", "BETIQ-10392450", "BETIQ-10408249", "BETIQ-10424060", "BETIQ-10439883", "BETIQ-10455718", "BETIQ-10471565", "BETIQ-10487424", "BETIQ-10503295", "BETIQ-10519178", "BETIQ-10535073", "BETIQ-10550980", "BETIQ-10566899", "BETIQ-10582830", "BETIQ-10598773", "BETIQ-10614728", "BETIQ-10630695", "BETIQ-10646674", "BETIQ-10662665", "BETIQ-10678668", "BETIQ-10694683", "BETIQ-10710710", "BETIQ-10726749", "BETIQ-10742800", "BETIQ-10758863", "BETIQ-10774938", "BETIQ-10791025", "BETIQ-10807124", "BETIQ-10823235", "BETIQ-10839358", "BETIQ-10855493", "BETIQ-10871640", "BETIQ-10887799", "BETIQ-10903970", "BETIQ-10920153", "BETIQ-10936348", "BETIQ-10952555", "BETIQ-10968774", "BETIQ-10985005", "BETIQ-11001248", "BETIQ-11017503", "BETIQ-11033770", "BETIQ-11050049", "BETIQ-11066340", "BETIQ-11082643", "BETIQ-11098958", "BETIQ-11115285", "BETIQ-11131624", "BETIQ-11147975", "BETIQ-11164338", "BETIQ-11180713", "BETIQ-11197100", "BETIQ-11213499", "BETIQ-11229910", "BETIQ-11246333", "BETIQ-11262768", "BETIQ-11279215", "BETIQ-11295674", "BETIQ-11312145", "BETIQ-11328628", "BETIQ-11345123", "BETIQ-11361630", "BETIQ-11378149", "BETIQ-11394680", "BETIQ-11411223", "BETIQ-11427778", "BETIQ-11444345", "BETIQ-11460924", "BETIQ-11477515", "BETIQ-11494118", "BETIQ-11510733", "BETIQ-11527360", "BETIQ-11543999", "BETIQ-11560650", "BETIQ-11577313", "BETIQ-11593988", "BETIQ-11610675", "BETIQ-11627374", "BETIQ-11644085", "BETIQ-11660808", "BETIQ-11677543", "BETIQ-11694290", "BETIQ-11711049", "BETIQ-11727820", "BETIQ-11744603", "BETIQ-11761398", "BETIQ-11778205", "BETIQ-11795024", "BETIQ-11811855", "BETIQ-11828698", "BETIQ-11845553", "BETIQ-11862420", "BETIQ-11879299", "BETIQ-11896190", "BETIQ-11913093", "BETIQ-11930008", "BETIQ-11946935", "BETIQ-11963874", "BETIQ-11980825", "BETIQ-11997788", "BETIQ-12014763", "BETIQ-12031750", "BETIQ-12048749", "BETIQ-12065760", "BETIQ-12082783", "BETIQ-12099818", "BETIQ-12116865", "BETIQ-12133924", "BETIQ-12150995", "BETIQ-12168078", "BETIQ-12185173", "BETIQ-12202280", "BETIQ-12219399", "BETIQ-12236530", "BETIQ-12253673", "BETIQ-12270828", "BETIQ-12287995", "BETIQ-12305174", "BETIQ-12322365", "BETIQ-12339568", "BETIQ-12356783", "BETIQ-12374010", "BETIQ-12391249", "BETIQ-12408500", "BETIQ-12425763", "BETIQ-12443038", "BETIQ-12460325", "BETIQ-12477624", "BETIQ-12494935", "BETIQ-12512258", "BETIQ-12529593", "BETIQ-12546940", "BETIQ-12564299", "BETIQ-12581670", "BETIQ-12599053", "BETIQ-12616448", "BETIQ-12633855", "BETIQ-12651274", "BETIQ-12668705", "BETIQ-12686148", "BETIQ-12703603", "BETIQ-12721070", "BETIQ-12738549", "BETIQ-12756040", "BETIQ-12773543", "BETIQ-12773543", "BETIQ-12791058", "BETIQ-12808585", "BETIQ-12826124", "BETIQ-12843675", "BETIQ-12861238", "BETIQ-12878813", "BETIQ-12896400", "BETIQ-12913999", "BETIQ-12931610", "BETIQ-12949233", "BETIQ-12966868", "BETIQ-12984515", "BETIQ-13002174", "BETIQ-13019845", "BETIQ-13037528", "BETIQ-13055223", "BETIQ-13072930", "BETIQ-13090649", "BETIQ-13108380", "BETIQ-13126123", "BETIQ-13143878", "BETIQ-13161645", "BETIQ-13179424", "BETIQ-13197215", "BETIQ-13215018", "BETIQ-13232833", "BETIQ-13250660", "BETIQ-13268499", "BETIQ-13286350", "BETIQ-13304213", "BETIQ-13322088", "BETIQ-13339975", "BETIQ-13357874", "BETIQ-13375785", "BETIQ-13393708", "BETIQ-13411643", "BETIQ-13429590", "BETIQ-13447549", "BETIQ-13465520", "BETIQ-13483503", "BETIQ-13501498", "BETIQ-13519505", "BETIQ-13537524", "BETIQ-13555555", "BETIQ-13573598", "BETIQ-13591653", "BETIQ-13609720", "BETIQ-13627799", "BETIQ-13645890", "BETIQ-13663993", "BETIQ-13682108", "BETIQ-13700235", "BETIQ-13718374", "BETIQ-13736525", "BETIQ-13736525", "BETIQ-13754688", "BETIQ-13772863", "BETIQ-13791050", "BETIQ-13809249", "BETIQ-13827460", "BETIQ-13845683", "BETIQ-13863918", "BETIQ-13882165", "BETIQ-13900424", "BETIQ-13918695", "BETIQ-13936978", "BETIQ-13955273", "BETIQ-13973580", "BETIQ-13991899", "BETIQ-14010230", "BETIQ-14028573", "BETIQ-14046928", "BETIQ-14065295", "BETIQ-14083674", "BETIQ-14102065", "BETIQ-14120468", "BETIQ-14138883", "BETIQ-14157310", "BETIQ-14175749", "BETIQ-14194200", "BETIQ-14212663", "BETIQ-14231138", "BETIQ-14249625", "BETIQ-14268124", "BETIQ-14286635", "BETIQ-14305158", "BETIQ-14323693", "BETIQ-14342240", "BETIQ-14360799", "BETIQ-14379370", "BETIQ-14397953", "BETIQ-14416548", "BETIQ-14435155", "BETIQ-14453774", "BETIQ-14472405", "BETIQ-14491048", "BETIQ-14509703", "BETIQ-14528370", "BETIQ-14547049", "BETIQ-14565740", "BETIQ-14584443", "BETIQ-14603158", "BETIQ-14621885", "BETIQ-14640624", "BETIQ-14659375", "BETIQ-14678138", "BETIQ-14696913", "BETIQ-14715700", "BETIQ-14734499", "BETIQ-14753310", "BETIQ-14772133", "BETIQ-14790968", "BETIQ-14809815", "BETIQ-14828674", "BETIQ-14847545", "BETIQ-14866428", "BETIQ-14885323", "BETIQ-14904230", "BETIQ-14923149", "BETIQ-14942080", "BETIQ-14961023", "BETIQ-14979978", "BETIQ-14998945", "BETIQ-15017924", "BETIQ-15036915", "BETIQ-15055918", "BETIQ-15074933", "BETIQ-15093960", "BETIQ-15112999", "BETIQ-15132050", "BETIQ-15151113", "BETIQ-15170188", "BETIQ-15189275", "BETIQ-15208374", "BETIQ-15227485", "BETIQ-15246608", "BETIQ-15265743", "BETIQ-15284890", "BETIQ-15304049", "BETIQ-15323220", "BETIQ-15342403", "BETIQ-15361598", "BETIQ-15380805", "BETIQ-15400024", "BETIQ-15419255", "BETIQ-15438498", "BETIQ-15457753", "BETIQ-15477020", "BETIQ-15496299", "BETIQ-15515590", "BETIQ-15534893", "BETIQ-15554208", "BETIQ-15573535", "BETIQ-15592874", "BETIQ-15612225", "BETIQ-15631588", "BETIQ-15650963", "BETIQ-15670350", "BETIQ-15689749", "BETIQ-15709160", "BETIQ-15728583", "BETIQ-15748018", "BETIQ-15767465", "BETIQ-15786924", "BETIQ-15806395", "BETIQ-15825878", "BETIQ-15845373", "BETIQ-15864880", "BETIQ-15884399", "BETIQ-15903930", "BETIQ-15923473", "BETIQ-15943028", "BETIQ-15962595", "BETIQ-15982174", "BETIQ-16001765", "BETIQ-16021368", "BETIQ-16040983", "BETIQ-16060610", "BETIQ-16080249", "BETIQ-16099900", "BETIQ-16119563", "BETIQ-16139238", "BETIQ-16158925", "BETIQ-16178624", "BETIQ-16198335", "BETIQ-16218058", "BETIQ-16237793", "BETIQ-16257540", "BETIQ-16277299", "BETIQ-16297070", "BETIQ-16316853", "BETIQ-16336648", "BETIQ-16356455", "BETIQ-16376274", "BETIQ-16396105", "BETIQ-16415948", "BETIQ-16435803", "BETIQ-16455670", "BETIQ-16475549", "BETIQ-16495440", "BETIQ-16515343", "BETIQ-16535258", "BETIQ-16555185", "BETIQ-16575124", "BETIQ-16595075", "BETIQ-16615038", "BETIQ-16635013", "BETIQ-16655000", "BETIQ-16674999", "BETIQ-16695010", "BETIQ-16715033", "BETIQ-16735068", "BETIQ-16755115", "BETIQ-16775174", "BETIQ-16795245", "BETIQ-16815328", "BETIQ-16835423", "BETIQ-16855530", "BETIQ-16875649", "BETIQ-16895780", "BETIQ-16915923", "BETIQ-16936078", "BETIQ-16956245", "BETIQ-16976424", "BETIQ-16996615", "BETIQ-17016818", "BETIQ-17037033", "BETIQ-17057260", "BETIQ-17077499", "BETIQ-17097750", "BETIQ-17097750", "BETIQ-17118013", "BETIQ-17138288", "BETIQ-17158575", "BETIQ-17178874", "BETIQ-17199185", "BETIQ-17219508", "BETIQ-17239843", "BETIQ-17260190", "BETIQ-17280549", "BETIQ-17300920", "BETIQ-17321303", "BETIQ-17341698", "BETIQ-17362105", "BETIQ-17382524", "BETIQ-17402955", "BETIQ-17423398", "BETIQ-17443853", "BETIQ-17464320", "BETIQ-17484799", "BETIQ-17505290", "BETIQ-17525793", "BETIQ-17546308", "BETIQ-17566835", "BETIQ-17587374", "BETIQ-17607925", "BETIQ-17628488", "BETIQ-17649063", "BETIQ-17669650", "BETIQ-17690249", "BETIQ-17710860", "BETIQ-17731483", "BETIQ-17752118", "BETIQ-17772765", "BETIQ-17793424", "BETIQ-17814095", "BETIQ-17834778", "BETIQ-17855473", "BETIQ-17876180", "BETIQ-17896899", "BETIQ-17917630", "BETIQ-17938373", "BETIQ-17959128", "BETIQ-17979895", "BETIQ-18000674", "BETIQ-18021465", "BETIQ-18042268", "BETIQ-18063083", "BETIQ-18083910", "BETIQ-18104749", "BETIQ-18125600", "BETIQ-18146463", "BETIQ-18167338", "BETIQ-18182825", "BETIQ-18209124", "BETIQ-18230035", "BETIQ-18250958", "BETIQ-18271893", "BETIQ-18292840", "BETIQ-18313799", "BETIQ-18334770", "BETIQ-18355753", "BETIQ-18376748", "BETIQ-18397755", "BETIQ-18418774", "BETIQ-18439805", "BETIQ-18460848", "BETIQ-18481903", "BETIQ-18502970", "BETIQ-18524049", "BETIQ-18545140", "BETIQ-18566243", "BETIQ-18587358", "BETIQ-18608485", "BETIQ-18629624", "BETIQ-18650775", "BETIQ-18671938", "BETIQ-18693113", "BETIQ-18714300", "BETIQ-18735499", "BETIQ-18756710", "BETIQ-18777933", "BETIQ-18799168", "BETIQ-18820415", "BETIQ-18841674", "BETIQ-18862945", "BETIQ-18884228", "BETIQ-18905523", "BETIQ-18926830", "BETIQ-18948149", "BETIQ-18969480", "BETIQ-18990823", "BETIQ-19012178", "BETIQ-19033545", "BETIQ-19054924", "BETIQ-19076315", "BETIQ-19076315", "BETIQ-19097718", "BETIQ-19119133", "BETIQ-19140560", "BETIQ-19161999", "BETIQ-19183450", "BETIQ-19204913", "BETIQ-19226388", "BETIQ-19247875", "BETIQ-19269374", "BETIQ-19290885", "BETIQ-19312408", "BETIQ-19333943", "BETIQ-19355490", "BETIQ-19377049", "BETIQ-19398620", "BETIQ-19420203", "BETIQ-19441798", "BETIQ-19463405", "BETIQ-19485024", "BETIQ-19506655", "BETIQ-19528298", "BETIQ-19549953", "BETIQ-19571620", "BETIQ-19593299", "BETIQ-19614990", "BETIQ-19636693", "BETIQ-19658408", "BETIQ-19680135", "BETIQ-19701874", "BETIQ-19723625", "BETIQ-19745388", "BETIQ-19767163", "BETIQ-19788950", "BETIQ-19810749", "BETIQ-19832560", "BETIQ-19854383", "BETIQ-19876218", "BETIQ-19898065", "BETIQ-19919924", "BETIQ-19941795", "BETIQ-19963678", "BETIQ-19985573", "BETIQ-20007480", "BETIQ-20029399", "BETIQ-20051330", "BETIQ-20073273", "BETIQ-20095228", "BETIQ-20117195", "BETIQ-20139174", "BETIQ-20161165", "BETIQ-20183168", "BETIQ-20205183", "BETIQ-20227210", "BETIQ-20249249", "BETIQ-20271300", "BETIQ-20293363", "BETIQ-20315438", "BETIQ-20337525", "BETIQ-20359624", "BETIQ-20381735", "BETIQ-20403858", "BETIQ-20425993", "BETIQ-20448140", "BETIQ-20470299", "BETIQ-20492470", "BETIQ-20514653", "BETIQ-20536848", "BETIQ-20559055", "BETIQ-20581274", "BETIQ-20603505", "BETIQ-20625748", "BETIQ-20648003", "BETIQ-20670270", "BETIQ-20692549", "BETIQ-20714840", "BETIQ-20737143", "BETIQ-20759458", "BETIQ-20781785", "BETIQ-20804124", "BETIQ-20826475", "BETIQ-20848838", "BETIQ-20871213", "BETIQ-20893600", "BETIQ-20915999", "BETIQ-20938410", "BETIQ-20960833", "BETIQ-20983268", "BETIQ-21005715", "BETIQ-21028174", "BETIQ-21050645", "BETIQ-21073128", "BETIQ-21095623", "BETIQ-21118130", "BETIQ-21140649", "BETIQ-21163180", "BETIQ-21185723", "BETIQ-21208278", "BETIQ-21230845", "BETIQ-21253424", "BETIQ-21276015", "BETIQ-21298618", "BETIQ-21321233", "BETIQ-21343860", "BETIQ-21343860", "BETIQ-21366499", "BETIQ-21389150", "BETIQ-21411813", "BETIQ-21434488", "BETIQ-21457175", "BETIQ-21479874", "BETIQ-21502585", "BETIQ-21525308", "BETIQ-21548043", "BETIQ-21570790", "BETIQ-21593549", "BETIQ-21616320", "BETIQ-21639103", "BETIQ-21661898", "BETIQ-21684705", "BETIQ-21707524", "BETIQ-21730355", "BETIQ-21753198", "BETIQ-21776053", "BETIQ-21798920", "BETIQ-21821799", "BETIQ-21844690", "BETIQ-21867593", "BETIQ-21890508", "BETIQ-21913435", "BETIQ-21936374", "BETIQ-21959325", "BETIQ-21982288", "BETIQ-22005263", "BETIQ-22028250", "BETIQ-22051249", "BETIQ-22074260", "BETIQ-22097283", "BETIQ-22120318", "BETIQ-22143365", "BETIQ-22166424", "BETIQ-22189495", "BETIQ-22212578", "BETIQ-22235673", "BETIQ-22258780", "BETIQ-22281899", "BETIQ-22305030", "BETIQ-22328173", "BETIQ-22351328", "BETIQ-22374495", "BETIQ-22397674", "BETIQ-22420865", "BETIQ-22444068", "BETIQ-22467283", "BETIQ-22490510", "BETIQ-22513749", "BETIQ-22537000", "BETIQ-22560263", "BETIQ-22583538", "BETIQ-22606825", "BETIQ-22630124", "BETIQ-22653435", "BETIQ-22653435", "BETIQ-22676758", "BETIQ-22700093", "BETIQ-22723440", "BETIQ-22746799", "BETIQ-22770170", "BETIQ-22793553", "BETIQ-22816948", "BETIQ-22840355", "BETIQ-22863774", "BETIQ-22887205", "BETIQ-22910648", "BETIQ-22934103", "BETIQ-22957570", "BETIQ-22981049", "BETIQ-23004540", "BETIQ-23028043", "BETIQ-23051558", "BETIQ-23075085", "BETIQ-23098624", "BETIQ-23122175", "BETIQ-23145738", "BETIQ-23169313", "BETIQ-23192900", "BETIQ-23216499", "BETIQ-23240110", "BETIQ-23263733", "BETIQ-23287368", "BETIQ-23311015", "BETIQ-23334674", "BETIQ-23358345", "BETIQ-23382028", "BETIQ-23405723", "BETIQ-23429430", "BETIQ-23453149", "BETIQ-23476880", "BETIQ-23500623", "BETIQ-23524378", "BETIQ-23548145", "BETIQ-23571924", "BETIQ-23595715", "BETIQ-23619518", "BETIQ-23643333", "BETIQ-23667160", "BETIQ-23690999", "BETIQ-23714850", "BETIQ-23738713", "BETIQ-23762588", "BETIQ-23786475", "BETIQ-23810374", "BETIQ-23834285", "BETIQ-23858208", "BETIQ-23882143", "BETIQ-23906090", "BETIQ-23930049", "BETIQ-23954020", "BETIQ-23978003", "BETIQ-24001998", "BETIQ-24026005", "BETIQ-24050024", "BETIQ-24074055", "BETIQ-24098098", "BETIQ-24122153", "BETIQ-24146220", "BETIQ-24170299", "BETIQ-24194390", "BETIQ-24218493", "BETIQ-24242608", "BETIQ-24266735", "BETIQ-24290874", "BETIQ-24315025", "BETIQ-24339188", "BETIQ-24363363", "BETIQ-24387550", "BETIQ-24411749", "BETIQ-24435960", "BETIQ-24460183", "BETIQ-24484418", "BETIQ-24508665", "BETIQ-24532924", "BETIQ-24557195", "BETIQ-24581478", "BETIQ-24605773", "BETIQ-24630080", "BETIQ-24654399", "BETIQ-24678730", "BETIQ-24703073", "BETIQ-24727428", "BETIQ-24727428", "BETIQ-24751795", "BETIQ-24776174", "BETIQ-24800565", "BETIQ-24824968", "BETIQ-24849383", "BETIQ-24873810", "BETIQ-24898249", "BETIQ-24922700", "BETIQ-24947163", "BETIQ-24971638", "BETIQ-24996125", "BETIQ-25020624", "BETIQ-25045135", "BETIQ-25069658", "BETIQ-25094193", "BETIQ-25118740", "BETIQ-25143299", "BETIQ-25167870", "BETIQ-25192453", "BETIQ-25217048", "BETIQ-25241655", "BETIQ-25266274", "BETIQ-25290905", "BETIQ-25315548", "BETIQ-25340203", "BETIQ-25364870", "BETIQ-25389549", "BETIQ-25414240", "BETIQ-25438943", "BETIQ-25463658", "BETIQ-25488385", "BETIQ-25513124", "BETIQ-25537875", "BETIQ-25562638", "BETIQ-25587413", "BETIQ-25612200", "BETIQ-25636999", "BETIQ-25661810", "BETIQ-25686633", "BETIQ-25711468", "BETIQ-25736315", "BETIQ-25761174", "BETIQ-25786045", "BETIQ-25810928", "BETIQ-25835823", "BETIQ-25860730", "BETIQ-25885649", "BETIQ-25910580", "BETIQ-25935523", "BETIQ-25960478", "BETIQ-25985445", "BETIQ-26010424", "BETIQ-26035415", "BETIQ-26060418", "BETIQ-26085433", "BETIQ-26110460", "BETIQ-26135499", "BETIQ-26160550", "BETIQ-26185613", "BETIQ-26210688", "BETIQ-26235775", "BETIQ-26260874", "BETIQ-26285985", "BETIQ-26311108", "BETIQ-26336243", "BETIQ-26361390", "BETIQ-26386549", "BETIQ-26411720", "BETIQ-26436903", "BETIQ-26462098"
];

const TOP_5_LEAGUE_IDS = ['152', '302', '207', '175', '168']; 
const CAN_LEAGUE_ID = '28'; 

const VALID_USER_CODES = new Set(VALID_CODES_ARRAY);

const STRINGS: Record<Language, any> = {
  FR: {
    loading: "Calcul IA Fondamentale...",
    error: "Erreur d'analyse IA",
    freeTitle: "SECONDE ZONE",
    vipTitle: "CHOCS DU JOUR",
    topVip: "LES 3 GAGNANTS DU JOUR",
    allVip: "TOUS LES PRONOSTICS",
    vipAccess: "MODE VIP ACTIVÉ",
    buyVip: "Passer VIP (30 jours)",
    enterCode: "Code d'activation...",
    vipInsight: "SCORES EXACTS (VIP)",
    algoVerdict: "Analyse Tactique IA",
    searchPlaceholder: "Rechercher un match ou une ligue..."
  },
  EN: {
    loading: "AI Analysis in Progress...",
    error: "AI Analysis Error",
    freeTitle: "SECOND ZONE",
    vipTitle: "TODAY'S CLASHES",
    topVip: "TOP 3 WINNERS",
    allVip: "ALL PREDICTIONS",
    vipAccess: "VIP MODE ACTIVE",
    buyVip: "Get VIP Access",
    enterCode: "Activation Code...",
    vipInsight: "EXACT SCORES (VIP)",
    algoVerdict: "AI Tactical Analysis",
    searchPlaceholder: "Search match or league..."
  }
};

const ELITE_TEAMS = ['Real Madrid', 'Barcelona', 'Manchester City', 'Liverpool', 'Arsenal', 'Bayern Munich', 'PSG', 'Inter', 'AC Milan', 'Juventus', 'Dortmund', 'Chelsea', 'Atletico', 'Man Utd', 'Tottenham'];
const isPopularMatch = (match: FootballMatch) => ELITE_TEAMS.some(t => match.homeTeam.includes(t) || match.awayTeam.includes(t));

const DateSelector: React.FC<{ selectedDate: string, onDateChange: (d: string) => void }> = ({ selectedDate, onDateChange }) => (
  <div className="flex gap-2 overflow-x-auto no-scrollbar py-3">
    {[0,1,2,3,4,5,6,7].map(i => {
      const d = new Date(); d.setDate(d.getDate() + i);
      const iso = d.toISOString().split('T')[0];
      const isSel = iso === selectedDate;
      return (
        <button key={iso} onClick={() => onDateChange(iso)} className={`flex-shrink-0 flex flex-col items-center justify-center min-w-[3.5rem] h-14 rounded-2xl border transition-all ${isSel ? 'bg-blue-600 border-blue-400 text-white' : 'bg-[#0b1121] border-white/5 text-slate-500'}`}>
          <span className="text-[7px] font-black uppercase">{d.toLocaleDateString('fr-FR', { weekday: 'short' })}</span>
          <span className="text-sm font-black italic">{d.getDate()}</span>
        </button>
      );
    })}
  </div>
);

const LeagueSelector: React.FC<{ selected: string, onSelect: (s: string) => void }> = ({ selected, onSelect }) => {
  const categories = [
    { id: 'all', name: 'Tous', icon: <Globe size={12}/> },
    { id: 'top5', name: 'Top 5', icon: <TrendingUp size={12}/> },
    { id: 'can', name: 'CAN', icon: <Trophy size={12}/> },
    { id: 'others', name: 'Autres', icon: <LayoutGrid size={12}/> }
  ];

  return (
    <div className="flex gap-2 overflow-x-auto no-scrollbar py-2">
      {categories.map(cat => (
        <button 
          key={cat.id} 
          onClick={() => onSelect(cat.id)}
          className={`flex-shrink-0 flex items-center gap-2 px-5 py-2.5 rounded-full text-[10px] font-black uppercase border transition-all ${selected === cat.id ? 'bg-[#c18c32] border-[#c18c32] text-slate-950 shadow-lg shadow-[#c18c32]/20' : 'bg-[#0b1121] border-white/5 text-slate-500'}`}
        >
          {cat.icon}
          {cat.name}
        </button>
      ))}
    </div>
  );
};

const AuthView: React.FC = () => {
  const [isLogin, setIsLogin] = useState(true);
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [error, setError] = useState('');
  const [loading, setLoading] = useState(false);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setLoading(true);
    setError('');
    try {
      if (isLogin) {
        await signInWithEmailAndPassword(auth, email, password);
      } else {
        await createUserWithEmailAndPassword(auth, email, password);
      }
    } catch (err: any) {
      setError('Erreur d\'authentification.');
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="min-h-screen bg-[#020617] flex flex-col items-center justify-center p-6">
      <div className="mb-10 text-center">
        <div className="bg-[#0b1121] p-6 rounded-3xl border border-white/10 w-fit mx-auto mb-4 shadow-2xl">
          <BrainCircuit size={48} className="text-blue-400" />
        </div>
        <h1 className="text-4xl font-black italic tracking-tighter text-white uppercase">BETI<span className="text-orange-500">Q</span></h1>
      </div>
      <div className="w-full max-w-sm bg-[#0b1121] border border-white/5 p-8 rounded-[2.5rem] shadow-2xl">
        <div className="flex bg-[#020617] p-1 rounded-2xl mb-8 border border-white/5">
          <button onClick={() => setIsLogin(true)} className={`flex-1 py-3 rounded-xl text-[10px] font-black uppercase transition-all ${isLogin ? 'bg-blue-600 text-white' : 'text-slate-500'}`}>CONNEXION</button>
          <button onClick={() => setIsLogin(false)} className={`flex-1 py-3 rounded-xl text-[10px] font-black uppercase transition-all ${!isLogin ? 'bg-blue-600 text-white' : 'text-slate-500'}`}>S'INSCRIRE</button>
        </div>
        <form onSubmit={handleSubmit} className="space-y-4">
          <input type="email" placeholder="Email" required value={email} onChange={(e) => setEmail(e.target.value)} className="w-full bg-[#020617] border border-white/10 rounded-xl py-4 px-5 text-xs text-white outline-none focus:border-blue-500/50" />
          <input type="password" placeholder="Mot de passe" required value={password} onChange={(e) => setPassword(e.target.value)} className="w-full bg-[#020617] border border-white/10 rounded-xl py-4 px-5 text-xs text-white outline-none focus:border-blue-500/50" />
          {error && <div className="text-[10px] text-rose-500 font-black text-center">{error}</div>}
          <button disabled={loading} className="w-full bg-blue-600 text-white font-black py-4 rounded-xl text-[11px] uppercase shadow-lg shadow-blue-600/20">
            {loading ? <Loader2 className="animate-spin mx-auto" size={16} /> : (isLogin ? 'ACCÉDER' : 'CRÉER COMPTE')}
          </button>
        </form>
      </div>
    </div>
  );
};

const PredictionsView: React.FC<any> = ({ matches, loading, language, isVip, selectedDate, onDateChange, onRefresh }) => {
  const navigate = useNavigate();
  const [searchTerm, setSearchTerm] = useState('');
  const S = STRINGS[language];

  const filtered = useMemo(() => {
    return matches.filter(m => 
      m.homeTeam.toLowerCase().includes(searchTerm.toLowerCase()) || 
      m.awayTeam.toLowerCase().includes(searchTerm.toLowerCase())
    );
  }, [matches, searchTerm]);

  const { vipHome, freeHome } = useMemo(() => {
    const vip = filtered.filter(isPopularMatch).slice(0, 2);
    const free = filtered.filter(m => !isPopularMatch(m)).slice(0, 3);
    return { vipHome: vip, freeHome: free };
  }, [filtered]);

  return (
    <div className="pb-32 px-5 max-w-2xl mx-auto">
      <header className="flex items-center justify-between py-8">
        <div className="flex items-center gap-3">
           <BrainCircuit size={28} className="text-blue-400" />
           <h1 className="text-3xl font-black italic tracking-tighter text-white uppercase">BETI<span className="text-orange-500">Q</span></h1>
        </div>
        <button onClick={onRefresh} className="p-3 bg-slate-900/50 rounded-2xl border border-white/5">
          <RefreshCw size={16} className={loading ? 'animate-spin text-orange-500' : 'text-slate-400'} />
        </button>
      </header>

      <div className="mb-8 space-y-4">
        <div className="relative">
          <Search size={18} className="absolute left-4 top-1/2 -translate-y-1/2 text-slate-600" />
          <input 
            type="text" 
            placeholder={S.searchPlaceholder}
            value={searchTerm}
            onChange={(e) => setSearchTerm(e.target.value)}
            className="w-full bg-[#0b1121] border border-white/5 rounded-2xl py-4 pl-12 pr-6 text-xs text-white outline-none focus:border-blue-500/30"
          />
        </div>
        <DateSelector selectedDate={selectedDate} onDateChange={onDateChange} />
      </div>

      <div className="space-y-10">
        <section className="space-y-4">
          <div className="flex items-center gap-2">
            <Crown size={14} className="text-orange-500" />
            <h3 className="text-[10px] font-black text-slate-500 uppercase tracking-widest italic">{S.vipTitle}</h3>
          </div>
          <div className="grid grid-cols-1 gap-4">
            {vipHome.map(m => (
              <MatchCard key={m.id} match={m} isVipUser={isVip} forceLock={!isVip} onClick={(m) => navigate(`/match/${m.id}`, { state: { match: m, forceLock: !isVip } })} />
            ))}
          </div>
        </section>

        <section className="space-y-4">
          <div className="flex items-center gap-2">
            <Zap size={14} className="text-blue-400" />
            <h3 className="text-[10px] font-black text-slate-500 uppercase tracking-widest italic">{S.freeTitle}</h3>
          </div>
          <div className="grid grid-cols-1 gap-4">
            {freeHome.map(m => (
              <MatchCard key={m.id} match={m} isVipUser={isVip} forceLock={false} onClick={(m) => navigate(`/match/${m.id}`, { state: { match: m, forceLock: false } })} />
            ))}
          </div>
        </section>
      </div>
    </div>
  );
};

const VipZoneView: React.FC<any> = ({ matches, loading, language, isVip, selectedDate, onDateChange }) => {
  const navigate = useNavigate();
  const [searchTerm, setSearchTerm] = useState('');
  const [selectedLeagueType, setSelectedLeagueType] = useState('all');
  const S = STRINGS[language];
  
  const filtered = useMemo(() => {
    let base = matches.filter(m => 
      m.homeTeam.toLowerCase().includes(searchTerm.toLowerCase()) || 
      m.awayTeam.toLowerCase().includes(searchTerm.toLowerCase())
    );

    if (selectedLeagueType === 'top5') {
      return base.filter(m => m.league_id && TOP_5_LEAGUE_IDS.includes(m.league_id));
    } else if (selectedLeagueType === 'can') {
      return base.filter(m => m.league_id === CAN_LEAGUE_ID || m.league.toLowerCase().includes('africa cup') || m.league.toLowerCase().includes('can'));
    } else if (selectedLeagueType === 'others') {
      return base.filter(m => m.league_id && !TOP_5_LEAGUE_IDS.includes(m.league_id) && m.league_id !== CAN_LEAGUE_ID);
    }
    
    return base;
  }, [matches, searchTerm, selectedLeagueType]);

  const winners3 = useMemo(() => filtered.filter(isPopularMatch).slice(0, 3), [filtered]);
  const others = useMemo(() => filtered.filter(m => !winners3.some(t => t.id === m.id)), [filtered, winners3]);

  return (
    <div className="p-5 pb-32 max-w-2xl mx-auto space-y-6">
      <header className="flex items-center justify-between pt-4">
        <div className="flex items-center gap-3">
          <div className={`p-2.5 rounded-2xl ${isVip ? 'bg-[#c18c32] shadow-[#c18c32]/20' : 'bg-orange-500 shadow-orange-500/20'} shadow-lg`}>
            <Crown size={28} className="text-slate-950" />
          </div>
          <div>
            <h2 className="text-2xl font-black italic text-white uppercase tracking-tighter">{isVip ? 'PRONOSTICS ELITE' : 'ACCÈS VIP'}</h2>
            <p className="text-[8px] font-black text-slate-500 uppercase tracking-[0.3em]">IA FONDAMENTALE</p>
          </div>
        </div>
      </header>

      <div className="space-y-4">
        <div className="relative">
          <Search size={18} className="absolute left-4 top-1/2 -translate-y-1/2 text-slate-600" />
          <input 
            type="text" 
            placeholder={S.searchPlaceholder}
            value={searchTerm}
            onChange={(e) => setSearchTerm(e.target.value)}
            className="w-full bg-[#0b1121] border border-white/5 rounded-2xl py-4 pl-12 pr-6 text-xs text-white outline-none focus:border-blue-500/30"
          />
        </div>
        <LeagueSelector selected={selectedLeagueType} onSelect={setSelectedLeagueType} />
        <DateSelector selectedDate={selectedDate} onDateChange={onDateChange} />
      </div>

      {loading ? (
        <div className="py-24 text-center"><Loader2 className="animate-spin text-orange-500 mx-auto" size={40} /></div>
      ) : (
        <div className="space-y-12">
          <section className="space-y-5">
            <h3 className="text-[11px] font-black text-orange-500 uppercase tracking-widest italic">{S.topVip}</h3>
            <div className="space-y-4">
              {winners3.map(m => (
                <VipSafeCard key={m.id} match={m} isLocked={!isVip} onClick={() => navigate(`/match/${m.id}`, { state: { match: m, forceLock: !isVip } })} />
              ))}
            </div>
          </section>

          <section className="space-y-5">
            <h3 className="text-[11px] font-black text-slate-600 uppercase tracking-widest italic">LISTE COMPLÈTE</h3>
            <div className="grid grid-cols-1 gap-5">
              {others.map(m => (
                <MatchCard key={m.id} match={m} isVipUser={isVip} forceLock={!isVip} onClick={(m) => navigate(`/match/${m.id}`, { state: { match: m, forceLock: !isVip } })} />
              ))}
            </div>
          </section>
        </div>
      )}

      {!isVip && (
        <div className="mt-8 bg-[#0b1121] border border-orange-500/20 p-10 rounded-[3rem] text-center space-y-6 shadow-2xl">
          <Lock size={40} className="text-orange-500 mx-auto" />
          <p className="text-xs font-bold text-slate-300 italic uppercase">Scores exacts, Corners et Buteurs Élite.</p>
          <button onClick={() => navigate('/settings')} className="w-full bg-orange-500 text-slate-950 font-black py-5 rounded-2xl text-[11px] uppercase shadow-orange-500/20">PASSER VIP</button>
        </div>
      )}
    </div>
  );
};

const MatchDetailView: React.FC<any> = ({ language, isVip }) => {
  const { state } = useLocation();
  const navigate = useNavigate();
  const match = state?.match as FootballMatch;
  const forcedLock = state?.forceLock as boolean;
  const [data, setData] = useState<AnalysisResult | null>(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const S = STRINGS[language];

  const prepareAndAnalyze = async (m: FootballMatch) => {
    const cacheKey = `betiq_analysis_${m.id}_${language}`;
    const cachedData = localStorage.getItem(cacheKey);
    
    if (cachedData) {
      try {
        setData(JSON.parse(cachedData));
        return;
      } catch (e) {
        console.warn("Cache parsing error", e);
      }
    }

    setLoading(true);
    setError(null);
    try {
      if (m.league_id) {
        const standings = await fetchStandings(m.league_id);
        if (Array.isArray(standings)) {
          const h = standings.find(s => s.team_name.includes(m.homeTeam) || m.homeTeam.includes(s.team_name));
          const a = standings.find(s => s.team_name.includes(m.awayTeam) || m.awayTeam.includes(s.team_name));
          if (h) m.homeTeamStats = { standing: parseInt(h.overall_league_position), points: parseInt(h.overall_league_PTS), recentForm: h.overall_league_WDLW ? h.overall_league_WDLW.split('') : [] };
          if (a) m.awayTeamStats = { standing: parseInt(a.overall_league_position), points: parseInt(a.overall_league_PTS), recentForm: a.overall_league_WDLW ? a.overall_league_WDLW.split('') : [] };
        }
      }
      
      const res = await generatePredictionsAndAnalysis(m, language);
      if (!res || !res.predictions) throw new Error("No data returned");
      
      localStorage.setItem(cacheKey, JSON.stringify(res));
      setData(res);
    } catch (e) { 
      console.error("AI Analysis Error:", e);
      setError("Analyse IA en maintenance.");
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    if (match) prepareAndAnalyze(match);
  }, [match, language]);

  if (!match) return <Navigate to="/" />;

  return (
    <div className="min-h-screen bg-[#020617] pb-40">
      <nav className="p-6 sticky top-0 bg-[#020617]/90 backdrop-blur-2xl flex items-center justify-between z-50">
        <button onClick={() => navigate(-1)} className="p-3.5 bg-[#0b1121] border border-white/5 rounded-2xl text-slate-400">
          <ChevronLeft size={22} />
        </button>
        <span className="text-[11px] font-black uppercase text-white tracking-widest truncate max-w-[200px] italic">
          {match.homeTeam} VS {match.awayTeam}
        </span>
        <button className="p-3.5 bg-[#0b1121] border border-white/5 rounded-2xl text-slate-400">
          <Share2 size={20} />
        </button>
      </nav>

      <div className="px-6 space-y-8 max-w-2xl mx-auto">
        <div className="flex items-center gap-2.5 bg-[#0b1121]/50 w-fit px-4 py-2 rounded-xl border border-blue-500/10">
          <Activity size={14} className="text-blue-500" />
          <span className="text-[10px] font-black text-slate-400 uppercase tracking-[0.2em] italic">SIGNAL IA</span>
        </div>

        {error ? (
          <div className="bg-rose-500/10 p-10 rounded-[3rem] border border-rose-500/20 text-center space-y-4">
            <AlertTriangle size={40} className="text-rose-500 mx-auto" />
            <p className="text-xs font-black text-rose-500 uppercase">{error}</p>
            <button onClick={() => prepareAndAnalyze(match)} className="px-6 py-3 bg-rose-500 text-white rounded-xl text-[10px] font-black uppercase">Réessayer</button>
          </div>
        ) : loading ? (
          <div className="flex flex-col items-center py-24 gap-6">
            <Loader2 className="animate-spin text-blue-500" size={56} />
            <p className="text-[10px] font-black text-slate-500 uppercase tracking-[0.4em] text-center">{S.loading}</p>
          </div>
        ) : data && (
          <div className="space-y-6 animate-in fade-in slide-in-from-bottom-5 duration-500">
            {/* Predictions Style Screenshot */}
            <div className="grid grid-cols-1 gap-5">
              {data.predictions.map((p: any, i: number) => (
                <div key={i} className="bg-[#0b1121] p-8 rounded-[2.5rem] border border-white/5 flex justify-between items-center shadow-2xl relative overflow-hidden group">
                  <div className="absolute top-0 left-0 w-1 h-full bg-blue-500/40 group-hover:bg-blue-500 transition-colors"></div>
                  <div className="space-y-2">
                    <span className="text-[10px] font-bold text-blue-400 uppercase tracking-widest block">{p.type}</span>
                    <div className="text-2xl font-black text-white italic uppercase tracking-tight">{p.recommendation}</div>
                  </div>
                  <div className="text-right space-y-2">
                    <div className="text-4xl font-black text-white">{p.probability}%</div>
                    <div className="flex items-center justify-end gap-2">
                      <div className={`w-2 h-2 rounded-full ${p.confidence === Confidence.HIGH ? 'bg-emerald-500' : 'bg-amber-500'} shadow-[0_0_10px_currentColor]`}></div>
                      <span className="text-[10px] font-black text-slate-500 uppercase tracking-widest">
                        {p.confidence === Confidence.HIGH ? 'ÉLEVÉ' : 'MOYEN'}
                      </span>
                    </div>
                  </div>
                </div>
              ))}
            </div>

            {/* VIP Exact Scores Section */}
            <div className="bg-[#0b1121]/40 p-8 rounded-[3rem] border border-white/5 space-y-6">
              <div className="flex items-center gap-3">
                 <div className="p-2 bg-orange-500/10 rounded-lg border border-orange-500/20">
                   <Target size={16} className="text-[#c18c32]" />
                 </div>
                 <span className="text-[11px] font-black text-slate-400 uppercase tracking-[0.2em] italic">{S.vipInsight}</span>
              </div>
              
              {forcedLock && !isVip ? (
                 <div className="bg-slate-950/60 p-10 rounded-[2.5rem] border border-orange-500/10 text-center space-y-6">
                    <Lock size={32} className="text-orange-500 mx-auto" />
                    <p className="text-[10px] font-black text-slate-500 uppercase tracking-widest italic">Analyse VIP : Scores exacts verrouillés</p>
                    <button onClick={() => navigate('/settings')} className="bg-[#c18c32] text-slate-950 px-8 py-3.5 rounded-2xl text-[10px] font-black uppercase">Activer Elite</button>
                 </div>
              ) : (
                <div className="grid grid-cols-2 gap-4">
                  {data.vipInsight.exactScores.map((s, idx) => (
                    <div key={idx} className="bg-[#151c30] text-white p-7 rounded-[2rem] border border-white/5 text-center text-4xl font-black italic shadow-inner">
                      {s}
                    </div>
                  ))}
                </div>
              )}
            </div>

            {/* AI Verdict Text Box */}
            <div className="bg-[#0b1121] p-10 rounded-[3.5rem] border-l-8 border-blue-500 shadow-2xl relative">
               <div className="absolute top-6 right-8 text-blue-500/10"><BrainCircuit size={48} /></div>
               <span className="text-[10px] font-black uppercase text-slate-500 tracking-widest block mb-4 italic">{S.algoVerdict}</span>
               <p className="text-[15px] text-slate-200 leading-relaxed font-bold italic uppercase">{data.analysis}</p>
            </div>
          </div>
        )}
      </div>
    </div>
  );
};

const SettingsView: React.FC<any> = ({ language, setLanguage, isVip, setIsVip, userEmail }) => {
  const [code, setCode] = useState('');
  const S = STRINGS[language];

  const checkCode = (val: string) => {
    const trimmed = val.trim().toUpperCase();
    setCode(trimmed);
    
    if (trimmed === ADMIN_CODE) {
      setIsVip(true);
      if (userEmail) {
        localStorage.setItem(`btq_vip_status_${userEmail}`, 'true');
        localStorage.setItem(`btq_vip_type_${userEmail}`, 'admin');
      }
    } else if (VALID_USER_CODES.has(trimmed)) {
      setIsVip(true);
      if (userEmail) {
        localStorage.setItem(`btq_vip_status_${userEmail}`, 'true');
        localStorage.setItem(`btq_vip_type_${userEmail}`, 'limited');
        if (!localStorage.getItem(`btq_vip_start_${userEmail}`)) {
          localStorage.setItem(`btq_vip_start_${userEmail}`, Date.now().toString());
        }
      }
    }
  };

  return (
    <div className="p-6 pb-32 space-y-6 max-w-xl mx-auto">
      <div className="bg-[#0b1121] p-8 rounded-[2.5rem] border border-white/5">
        <div className="flex items-center gap-4 mb-8">
          <div className="p-4 bg-blue-500/10 rounded-2xl border border-blue-500/20"><UserCircle size={32} className="text-blue-400" /></div>
          <div><p className="text-sm font-bold text-white truncate">{userEmail}</p></div>
        </div>
        <div className="space-y-4">
          <h2 className="text-[9px] font-black uppercase text-slate-600 tracking-widest">Langue de l'IA</h2>
          <div className="flex gap-4">
            {['FR', 'EN'].map(l => (
              <button key={l} onClick={() => { setLanguage(l as Language); localStorage.setItem('lang', l); }} className={`flex-1 py-4 rounded-xl text-[10px] font-black border transition-all ${language === l ? 'bg-blue-600 border-blue-600 text-white' : 'bg-[#020617] border-white/5 text-slate-700'}`}>{l}</button>
            ))}
          </div>
        </div>
      </div>

      {!isVip ? (
        <div className="bg-[#0b1121] p-10 rounded-[3rem] border border-white/5 space-y-8 text-center shadow-2xl relative overflow-hidden">
          <div className="absolute top-0 left-0 w-full h-1 bg-orange-500 shadow-[0_0_15px_rgba(249,115,22,0.5)]"></div>
          <Crown size={48} className="text-orange-500 mx-auto" />
          <input type="text" value={code} onChange={(e) => checkCode(e.target.value)} placeholder={S.enterCode} className="w-full bg-[#020617] border border-white/10 rounded-2xl py-5 text-center font-black text-white uppercase outline-none focus:border-orange-500/50" />
          <div className="text-[8px] font-black text-slate-700 uppercase">OU</div>
          <button onClick={() => window.open(PAYMENT_LINK, '_blank')} className="w-full bg-orange-500 text-slate-950 font-black py-5 rounded-2xl text-[11px] uppercase active:scale-95 transition-transform">ACTIVER MON PASS VIP (30J)</button>
        </div>
      ) : (
        <div className="bg-[#c18c32]/5 p-12 rounded-[3.5rem] border border-[#c18c32]/20 text-center shadow-2xl">
          <CheckCircle2 size={48} className="text-[#c18c32] mx-auto mb-4" />
          <span className="text-3xl font-black text-white italic block uppercase">PASS VIP ACTIF</span>
          <p className="text-[10px] font-bold text-[#c18c32]/50 uppercase tracking-widest mt-2">Accès Illimité Elite</p>
        </div>
      )}

      <button onClick={() => signOut(auth)} className="w-full bg-rose-500/5 p-7 rounded-[2.5rem] border border-rose-500/10 flex items-center justify-center gap-4 text-rose-500 transition-colors hover:bg-rose-500/10">
        <LogOut size={22} /><span className="text-xs font-black uppercase italic">Déconnexion</span>
      </button>
    </div>
  );
};

const App: React.FC = () => {
  const [user, setUser] = useState<FirebaseUser | null>(null);
  const [authLoading, setAuthLoading] = useState(true);
  const [language, setLanguage] = useState<Language>(() => (localStorage.getItem('lang') as Language) || 'FR');
  const [isVip, setIsVip] = useState<boolean>(false);
  const [matches, setMatches] = useState<FootballMatch[]>([]);
  const [loading, setLoading] = useState(false);
  const [selectedDate, setSelectedDate] = useState<string>(new Date().toISOString().split('T')[0]);

  useEffect(() => {
    const unsub = onAuthStateChanged(auth, (u) => {
      setUser(u);
      if (u && u.email) {
        const type = localStorage.getItem(`btq_vip_type_${u.email}`);
        const status = localStorage.getItem(`btq_vip_status_${u.email}`) === 'true';
        if (status) {
          if (type === 'admin') setIsVip(true);
          else if (type === 'limited') {
            const startStr = localStorage.getItem(`btq_vip_start_${u.email}`);
            if (startStr) {
              const start = parseInt(startStr);
              if (Date.now() - start > 30 * 24 * 60 * 60 * 1000) {
                setIsVip(false);
                localStorage.setItem(`btq_vip_status_${u.email}`, 'false');
              } else setIsVip(true);
            } else setIsVip(false);
          } else setIsVip(status);
        } else setIsVip(false);
      } else setIsVip(false);
      setAuthLoading(false);
    });
    return () => unsub();
  }, []);

  const fetchMatches = async (date: string) => {
    if (loading) return;
    setLoading(true);
    try {
      const data = await fetchMatchesByDate(date);
      setMatches(data.map(m => ({
        id: m.match_id, league: m.league_name, league_id: m.league_id, homeTeam: m.match_hometeam_name,
        awayTeam: m.match_awayteam_name, homeLogo: m.team_home_badge,
        awayLogo: m.team_away_badge, time: m.match_time, status: m.match_status,
        stats: { homeForm: [], awayForm: [], homeRank: 0, awayRank: 0, h2h: '' },
        predictions: []
      })));
    } catch (e) { console.error(e); } finally { setLoading(false); }
  };

  useEffect(() => { if (user) fetchMatches(selectedDate); }, [selectedDate, user]);

  if (authLoading) return (
    <div className="min-h-screen bg-[#020617] flex flex-col items-center justify-center gap-8">
      <BrainCircuit size={64} className="text-blue-400 animate-pulse" />
      <p className="text-[12px] font-black text-slate-700 uppercase tracking-[0.5em]">SYNC BETIQ IA...</p>
    </div>
  );

  if (!user) return <AuthView />;

  return (
    <HashRouter>
      <div className="min-h-screen bg-[#020617] text-slate-100">
        <Routes>
          <Route path="/" element={<PredictionsView matches={matches} loading={loading} language={language} isVip={isVip} selectedDate={selectedDate} onDateChange={setSelectedDate} onRefresh={() => fetchMatches(selectedDate)} />} />
          <Route path="/settings" element={<SettingsView language={language} setLanguage={setLanguage} isVip={isVip} setIsVip={setIsVip} userEmail={user.email} />} />
          <Route path="/match/:id" element={<MatchDetailView language={language} isVip={isVip} />} />
          <Route path="/vip" element={<VipZoneView matches={matches} loading={loading} language={language} isVip={isVip} selectedDate={selectedDate} onDateChange={setSelectedDate} />} />
          <Route path="*" element={<Navigate to="/" />} />
        </Routes>

        <nav className="fixed bottom-6 left-6 right-6 bg-[#0b1121]/95 backdrop-blur-3xl border border-white/10 rounded-[2.5rem] py-3 flex items-center justify-around z-50 shadow-2xl">
          <Link to="/" className={`flex flex-col items-center gap-1.5 p-3 text-slate-500 hover:text-blue-400`}>
            <LayoutGrid size={22} /><span className="text-[8px] font-black uppercase tracking-tighter">DIRECT</span>
          </Link>
          
          <Link to="/vip" className="flex flex-col items-center group relative px-4">
            <div className={`${isVip ? 'bg-[#c18c32] shadow-[#c18c32]/20' : 'bg-orange-500 shadow-orange-500/20'} p-3.5 rounded-full -mt-12 border-[6px] border-[#020617] shadow-xl group-active:scale-90 transition-transform`}>
              {isVip ? <Crown size={26} className="text-slate-950" /> : <Lock size={24} className="text-slate-950" />}
            </div>
            <span className={`text-[9px] font-black mt-1.5 uppercase italic tracking-widest ${isVip ? 'text-[#c18c32]' : 'text-orange-500'}`}>VIP</span>
          </Link>
          
          <Link to="/settings" className="flex flex-col items-center gap-1.5 p-3 text-slate-500 hover:text-blue-400">
            <Settings size={22} /><span className="text-[8px] font-black uppercase tracking-tighter">RÉGLAGES</span>
          </Link>
        </nav>
      </div>
    </HashRouter>
  );
};

export default App;